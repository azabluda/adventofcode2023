# https://adventofcode.com/2023/day/21
# Day 21: Step Counter

def step_counter(data):
    for steps in 6, 64:
        map = {r + 1j * c: val
               for r, row in enumerate(data.split('\n'))
               for c, val in enumerate(row)}
        rox = {pos for pos in map if map[pos] == '#'}
        cur = {pos for pos in map if map[pos] == 'S'}
        for _ in range(steps):
            cur = {pos + 1j ** i for pos in cur for i in range(4)} & {*map} - rox
        yield steps, len(cur)


def inputs():

    yield """
...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........
"""

    yield """
...................................................................................................................................
....#...#..............................#............#......................###..........#.......#...............#....#.......#.....
..#...#........####..#....#...#.#..#......#......#.##.......................#..#.......#.........#...#.........#...........#..##.#.
........#...#..........#.....#.....#.#.......#...##.##.#.................#..#.#.#..........##.........#.#.......#..#....#.....#....
............#....#.......##..#.......#....##...............................#.#........................#.#...#..........#...#...#...
..##.............#...........##.....##.#.....#.....#...........................##...#......###.#..#.#.........#..#..#..#...........
......#..............#...#....##......#.........#..#..............#..............#................#......#.....#.........##....#...
.....#....#......#..#..................#.##...#.......#........#....#.......#..................#......#...#.....................##.
..........#...####...#...##.##...#..#........#..###..#..........#.#...........#...##..#................#.....#...........#.#..#..#.
....................#...#....#.......#.............##........#.................#......#...##..#.#.#..#.......#..........#.......#..
...............#..#.#..............#...#####....#...............#.#.##...........#.....##..........#....#.##.##..#.................
.........#..##..#..#..#........#.#..##.#..#....#................#.#...#..........#...##..#....#.##.................................
.....#....#.....#......#......#..#.#..#..###...#.................................#.#......#.......#....##....#.#....#...#...#......
..........##..#...#.........#................#..........##.#...#..#...#...........#..#.....#......#..#.#.#.............#.......#...
....#....#....#.......#..........#..............................#..##.#....#............................#..#.......#......#....#...
..#..#....#........#...#....#.#..........................#....#........#...##.....................#.#.....#.##.....#..#.....#......
.....#......#..........##.....#...........#................#......##...##...#..............#.............#......#.#..#...#.#.....#.
.....#......##....#.....#.....#......#..............................#..#...#..........#.................#....#...##..........####..
.............#...#.....#.............#.#.#.........#.#..#.....#..........#....#..........#..##.....##.#.##....................#.#..
.###..##.#.##.....#.#..###..#....#...#....#...............##..................##................#....#.....#..#..#.................
.#..#.........#......#...........#..................#...........#.#..........#.................#...#.........#.#.......#.#.......#.
.##.......#.....##..........##...#..#............#.........#.......#.....#...#..##.........#..........##...#..........#....#.##....
.#............#.........#.............#........#...#...#....#................#.#.#....................#............#.............#.
.......#..#........#......#...............................#..##.....###..........#.#.............#...........##...#.#...#..#.......
...#......#................#...................#..#....##..................#....#.............#...###...........#.###..............
.................................#..#..........#..#.....#..#...#.....##.....#.......................##..##.............#....#.#....
........##...#....#......#....#................#..#....#....................#.....#.............#....#..#...................#......
..#...........#...............#...............................#..........##.#....#.#....#..........#.#..#.......#..#.#......#....#.
...............##............#.............#..........#......#.#......#...........................#.......##....#...............#..
...#...#.#..#.#...............#..........#..#.......##.#............#.....#..#....#.##....#...........#.#............#......#......
.#.#......#.#.#.#..#.......#...................###.#..........##...#.......#..#....................#..#....#.....##.......#........
......#.#.....#........##...#............##.................#...#..#.#.....#.#..##......................#...............#..#.......
...#....#.....#........................#........####.....###......#...#.......#.....#........#.........#..#..##.....#.....#...#.#..
........#..............#.#...........#.....#......#..........#............#.#...#.#..#.....#..........#.#.........#.......#...#....
.....#.....#....##....#..#............#..........#...#.................#..#...#...#.......##..............#...##.....#....#......#.
.........#.#.............#.........###..............#.#......#...........#..........#...#.....#...........#..............#.........
..#.........#...##...##.#....................#......#.........#.#......#..#..#...#.............................#.#......#..........
.#.....#.......#.......#.........#........#......#...#.....#..........#.....#.....#.#......#..................#....#...#...........
..#.#...............#..........#.#.#..#.....##......##...............#......##..#................##..............#..#....##.#.#..#.
..................##..........#..#.#.#........#....#....#.....#....#..#.....#.##...................................#...............
....#.....#.#..#........................#.......#.#.............#...#.##..#....#.........#.......#...................##......#.....
.......#....###.........................#.......#.##........###........#....#..#..##..................#............#.....#.........
...#.......#......#...............................#.#..#..#.#..#..#........#..#................#.##.#...........#.....#..#....#....
...#...........#.#...............#............#........#.#...##......#..##.#.#...............#...#......#........#.....#.#.....#...
....#.#...................#..........##.#.....#.........#...#..#..#.#.......#...#...#..#..........#...................#...#........
.......#....#...#..................##..................#....##....#....#......#..#.....#.........#.....#..#..........#..#..#.......
....#....#..............###...........#.......##...#.....#.#...#...........#.....#......#.......#.........................#.#...#..
....#...#....#.............#...#..#.....#.....................#.#...#..#....###.........#.#.......#........................#.......
..##.......#....................#...#..#.........#.........#........##....##........#.....###...#.....#.##...............#.#.##....
.........#.#.............##.#....##.#.#...#....#.#.#.......##............#.#.#..................#....#...#..#..............#.#.....
...............................#....#....#......#....##..#......#..#....................#....#..#...........#..................##..
....##..##............#..........#................#...............##..#.#..#....#..#..#...#..#................##.........#.....#...
.......#......................#.........#..........##..#....#.........#.....#...#...##..#............##..#......#.........#..#..#..
.#................#....#....#...............#.#....#..#.......#........................#..............#..#.#......#.......#.#......
...##............##.##.#.#.....#.#.....#.........#.....................#.............#.#.......##.#................................
....#....................................#.....#...#.....#.#..#......#.............#...#.....#.#...###..........#..................
.#..............#.........#.#...#....##.......#...#..##........#........###..#....##.....#...#...........##...#.....#..........#...
...##........#......#........#.##...........##................#.#..................#.##....#.#.......#................#..........#.
..............#......#..#...#...............#.#.#......#.#...........#.........................##...#.##...........................
.............#........#......#.........#......#...#.......#..........#......#...#..#.......#.......##...........#....#...........#.
..........#....#.....#..#...##.....#...##..#.#.................#.............#.#.................##...#..............#.............
..........#...##.....#...#..........#...##.#..#.......#....#..#.....#....#........#...#..........................#..#..............
.................##...##....#.#.............#.#...............#..........##..#....#..#.#.#..............#..#.....#.##..............
.........#.......##.........#.....#...#.......#.##.......#.............#...#..........#........#........#...........##.#...#.......
......#.....#..#.#...........#.........#.#.....###.....##..#........#....##.#..#.#..###.#......#.........#.............#...........
.................................................................S.................................................................
.......#......#.....##.#..........##...#.#.........#..............#..............#.....##....#........####...##....................
..........##....#...................#......#.#......##....#...#.....#..#..#.##.......#.##.......##..#...............#..............
...........#...#..............#...#..#....#.....#..#.#.......#.#...##......#......................##.#..#....#...........#.........
.............#..#...#.........................#......##....#.#.......#..#..............#...............##....#.....................
.........#......#...#..#...#...#............#.#.....#...#.#....#.......#.....#..........#.#....#....##.#.#...........#...#.........
.............#..................#.....#.#.......#.#..#..#...#........#.....#.....#...##.#...........#......#.#....#................
........................#.#......#.#.......#.......#...#......................#............#...........##.......##....#............
.............#..#....#.....................#.......#..............#..#..#....#...............#...................#............#....
...............#.........#..##........#......#.....#..#....#.#....................##...........#......#.#.#.#.#..............#..#..
...............##.#.##.......##..................###...........#...#.....#..#..##........#..#..#.....#......###....##..........#...
....#.............#....#.........#.#.##........#...##..#..#.....#................#......#......#...#...#.#........##...............
........#................#.......#.....#..............#.#.##..#....#......#........#.......#.....#.#.........#...#........#..#.....
.................#.....#...###..#..##..............................#..#.#......................#.#...#.#.#.#.#.............#..#.##.
..#.#..#..........#....##.......##.......#....#..#..##....#.......#..#....#....#...#.....#.#...............#...............#.....#.
........#.............##..#..#..#.....#..#...........#........#.#.#.#....#....#..#..###...............#........#.......#....#......
...........##.......#...........#....#.....##...#......#....#.###.#......##...........#........##.#.#......#.#.........#.#.........
.#......#................#..#.#..#........#####.........##..........#....#.......#.....#......#.#..................................
....##...##.#..............###.#....#....#..............##.........#.....................##.#..........#..##.............#.........
..........###...........#......#............................#...#...#.#..#...#....#..#..........#..#..##...............#..#..#..#..
.###...#........#.......#...#.........#..............#.....#.#......#..#....#....#.##...#..............#............#...#.#....#.#.
................#.....................#.#........#.........................##.#......#.#..#..##..#..#.............#.#..............
.#.#.....#.##....#........#..................#......##.......#.#..##..#...#......##.......#..#..##......#.......#........#.........
.#............#.....................#............#...........#..#.#.##...........#.......#...#...##........................#.....#.
.....#...#......##...................................#..#...#..................#.#.........##..#....................##......#...#..
....#....#...#...#.#.#.......#.............#..##...........#..#........#.......#......#.........#.............#....#..#............
.#.#..#.##..#.........#..................#.#...#.#.....#................#.#.#.......##..#...................#....##.......#..#.....
.#........#.#..##...............#...#.......#....#..............#.#..##.......#......#........##..............#....................
.............#.#....#............#..#...##.#.............#....................#...#...#.......#..#.............#....#...#......#.#.
.....#.#....#.....#...................#....#....#....#..........#.......##..........#............................#.....##...##.....
.#........#..#.#....#.#..................#..#.#...##...#.#.........#....#.....#.....#.#......#.............#..#.#.........#.....#..
.................#..#......#.........#...........#...........................#....#....#.....##........#.......#..#....#...........
....##................#...#...........#.....##.#.###........#...........###....####.#........#.................................#.#.
.....................#.................##......#...#...#...........#.....#....#..#...#.....#..........##.#....................##...
.#.#.#...#.......##...#.#.................#...#....#.....#..###.............#....#..#.#...#.............#...........####......#.##.
....#.........#.#..#..#......................#...........#...#............#...#....#.#..#.##..............#..........#.....#.......
...##.#........#........##....#..........#....#........#....#..#..##....................#.............#.......##....#.........###..
......#....#...#..##.......#..#..........##...........#.......#.....................................#...#...#....#....##...........
......#.#.#........#..............#...............#.#.................#......#...#...##................#.............##......#.....
.......##....#.................#..#..........#.....#..................................#........#..........#......#...#.............
..#........#........#.##......#..#...............##.............#.........#...........#..........#.#....#...####.....#.....#.......
..#.....#....##.........#...#...#...............#.........#............##.#.......................#..#.#.............##....#.......
....#.........###.#..#.#......#....#.#.........................#..#.......##.#................#..#........#......#.......#.........
......#.....................#........#.#..........#...#.#.......#.....##.##........#...........#.......#..........#.#..#..##.......
.........#......................#...##.#...........##.#.....#..............#..#..................#..............#..................
..#.#..#.........#..###...#....#.....#..................##................#...#...........##.###.#...............#...#....#....#...
...#........#.......#.............#.....#..................#....#...........##.##..........#.......#.....#.#.......##......#.......
....#..............#......#.......#.......#............#....#..##......#................#........#...#.#.#.....#.....#...#..#....#.
......#............#.........#.............#........#..#....#.........#.#..................#.........#........#...#.....#....#.#...
....##.#..#....#.#..#..#..#...#.....###...##......................#.#.##..............#............#....#........#.....#..#....#...
...............................##.#..#..........................#.......#............#.#....#...#...#.....##...#..##.#.#.##...#....
...#..#.#.............#...#.................#..............##..........................#..#.......#..#.###..#.......#...#..#.......
..........#........#........#..#......#..#.....##...........##.......................#...#.#.........#.#.#.#....#.#.##.........#...
..#..........#...##.##..........#..........#.#.............#.#.......#.#.#............#......#.....#...#..#.....#.........#..#..##.
...#.#....#...#....#....#.......#....................................#..#..........#..###...#.....#.......##..........#........#...
.................#.#..........##.......#.#.........#............#......#...........###......#.#.....#.........##.#..............#..
...#.##...#..........#.......#..........#.#......#..................##.............#......##...##..........#........#........##.#..
.....#....##..#..#....#..........#.....#.##..#..##....................................#.##...#....#...#.#..............##...#..#...
...#....##.............#.#.....#.#.#...............................................#...#........#...............##..............#..
.....#..#..........#..#...............#................#........#.......................#...#.#....................#.#........#....
...#........#..#..#........#.............#..#...................#.............###...................#..........#..........#.....#..
......#..........#.....#.#..###....#.....#.......#...................................#.#......#........#...#.......................
.........#...#....#...#..#..#....#..........#...........................#........#.....#..#....#...#.....#..#............#..#.#..#.
..#..........##.......##.......##................#.............................#.#...#......#.#...............##....#..#..#..##....
.........#.......................#....#............#....#...................#............#....#.#.......#.......#...........#......
...................................................................................................................................
"""

for data in inputs():
    print(*step_counter(data.strip()))
